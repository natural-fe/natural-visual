<!--     
    Author    :Luo_0412
    BuildDate :2016-4-30
    Version   :1.0
    Function  :可视化实例与EXCEL导出
    Update    : 
-->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>智能统计分析</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link type="text/css" rel="stylesheet" href="css/daterangepicker-bs3.css"/>
    <style>
    </style>
</head>
<body>


<div class="container">

    <!-- 与顶部设置的间距 -->
    <div style="margin-top:20px;"></div>

    <!-- 可切换搜索框 -->
    <div class="col-sm-12 col-md-8">

        <div>
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active">
                    <a href="#home" aria-controls="home" role="tab" data-toggle="tab">乘车人数</a></li>
                <li role="presentation">
                    <a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">乘车率</a></li>
                <li role="presentation">
                    <a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">人员名单</a></li>
            </ul>

            <div style="margin-top:20px;"></div>

            <div class="tab-content">
                <!-- 乘车人数 -->
                <div role="tabpanel" class="tab-pane active" id="home">
                    <form class="form-inline">

                        <div class="form-group">
                            <label for="inputEmail3">起止时间</label>
                            <input type="text" readonly name="reservation"
                                   id="reservation" class="form-control" placeholder="点击操作"/>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputName2">线路</label>
                            <select name="" id="" class="form-control">
                                <option value=""></option>
                                <option value="">102线</option>
                                <option value="">103线</option>
                                <option value="">104线</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button type="button" id="num_btn" class="btn btn-primary">查询</button>
                            <button class="btn btn-default"
                                    onClick="$('#customers').tableExport({type: 'excel', escape: 'false'});">导出
                            </button>
                        </div>
                    </form>
                </div>

                <!-- 乘车率 -->
                <div role="tabpanel" class="tab-pane" id="profile">
                    <form class="form-inline">
                        <div class="form-group">
                            <label for="inputEmail3">起止时间</label>
                            <input type="text" readonly name="reservation"
                                   id="reservation2" class="form-control" placeholder="点击操作"/>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputName2"></label>
                            <button type="button" id="rate_btn" class="btn btn-primary">查询</button>
                            <button type="button" class="btn btn-default">导出</button>
                        </div>
                    </form>
                </div>

                <!-- 人员名单 -->
                <div role="tabpanel" class="tab-pane" id="messages">
                    <form class="form-inline">
                        <div class="form-group">
                            <label for="inputEmail3">起止时间</label>
                            <input type="text" readonly name="birthday"
                                   id="birthday" class="form-control" value=""/>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputName2">线路</label>
                            <select name="" class="form-control">
                                <option value=""></option>
                                <option value="">102线</option>
                                <option value="">103线</option>
                                <option value="">104线</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputName2">站点</label>
                            <select class="form-control">
                                <option value=""></option>
                                <option value="">海创园</option>
                                <option value="">蒋村商住区</option>
                                <option value="">杭州火车东站</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputName2" class="control-label"></label>
                            <button type="button" id="list_btn" class="btn btn-primary">查询</button>
                            <button class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
                                导出
                            </button>

                            <!-- Modal -->
                            <div class="modal fade" id="myModal" tabindex="-1" role="dialog"
                                 aria-labelledby="myModalLabel">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span></button>
                                            <h4 class="modal-title" id="myModalLabel">Modal title</h4>
                                        </div>
                                        <div class="modal-body">
                                            <table id="customers" class="table table-striped table-bordered">
                                                <thead>
                                                <tr class='warning'>
                                                    <th>Country</th>
                                                    <th>Population</th>
                                                    <th>Date</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <td>Chinna</td>
                                                    <td>1,363,480,000</td>
                                                    <td>March 24, 2014</td>
                                                </tr>
                                                <tr>
                                                    <td>India</td>
                                                    <td>1,241,900,000</td>
                                                    <td>March 24, 2014</td>
                                                </tr>
                                                <tr>
                                                    <td>United States</td>
                                                    <td>317,746,000</td>
                                                    <td>March 24, 2014</td>
                                                </tr>
                                                <tr>
                                                    <td>Indonesia</td>
                                                    <td>249,866,000</td>
                                                    <td>July 1, 2013</td>
                                                </tr>
                                                <tr>
                                                    <td>Brazil</td>
                                                    <td>201,032,714</td>
                                                    <td>July 1, 2013</td>
                                                </tr>
                                                </tbody>
                                            </table>

                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">Close
                                            </button>
                                            <button type="button" class="btn btn-primary" data-dismiss="modal"
                                                    onClick="$('#customers').tableExport({type: 'excel', escape: 'false'});">
                                                导出
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div> <!-- 标签页结束 -->
    </div> <!-- 搜索框栅格设置结束 -->

    <div class="col-sm-12" style="margin-top:20px;"></div>

    <!-- 可视化区域 -->
    <div class="col-sm-12 col-md-8">
        <div id="hello" style="min-height:300px; border:solid 1px;"></div>
    </div>

</div> <!-- container结束 -->

<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/moment.js"></script>
<script type="text/javascript" src="js/daterangepicker.js"></script>
<script type="text/javascript" src="js/echarts.min.js"></script>
<script type="text/javascript" src="table/jquery.base64.js"></script>
<script type="text/javascript" src="table/tableExport.js"></script>
<script type="text/javascript" src="table/jspdf/libs/sprintf.js"></script>
<script type="text/javascript" src="table/jspdf/jspdf.js"></script>
<script type="text/javascript" src="table/jspdf/libs/base64.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('#reservation,#reservation2').daterangepicker(null, function (start, end, label) {
            console.log(start.toISOString(), end.toISOString(), label);
        });
    });
    $(document).ready(function () {
        $('#birthday').daterangepicker({singleDatePicker: true}, function (start, end, label) {
            console.log(start.toISOString(), end.toISOString(), label);
        });
    });
</script>

<script type="text/javascript">


    $("#num_btn").click(function () {
        // $("#hello").show();
        /*初始化echarts实例=====================*/
        var myChart = echarts.init(document.getElementById('hello'));

        /* 指定图表的配置项和数据===============*/
        myChart.setOption({
            title: {
                text: '乘车人数统计',
                subtext: '404厂车系统'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['理论总人数', '实际总人数']
            },
            toolbox: {
                show: true,
                feature: {
                    mark: {show: true},
                    dataView: {show: true, readOnly: false},
                    magicType: {show: true, type: ['bar', 'line']},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    boundaryGap: false,
                    axisLabel: {
                        formatter: function (val) {
                            return val.split("").join("\n");
                        }
                    },
                    data: ['杭师大仓前校区', '益乐新村', '雅仕苑', '骆家庄', '蒋村商住区', '蒋村公交中心站', '杭州火车东站', '杭师大仓前校区', '益乐新村', '雅仕苑', '骆家庄', '蒋村商住区', '蒋村公交中心站', '杭州火车东站']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} 人'
                    }
                }
            ],
            series: [
                {
                    name: '理论总人数',
                    type: 'line',
                    data: [],
                    // markPoint : {
                    //     data : [
                    //         {type : 'max', name: '最大值'},
                    //         {type : 'min', name: '最小值'}
                    //     ]
                    // },
                    markLine: {
                        data: [
                            {type: 'average', name: '平均值'}
                        ]
                    }
                },
                {
                    name: '实际总人数',
                    type: 'line',
                    data: [],
                    // markPoint : {
                    //     data : [
                    //         {name : '周最低', value : -2, xAxis: 1, yAxis: -1.5}
                    //     ]
                    // },
                    markLine: {
                        data: [
                            {type: 'average', name: '平均值'}
                        ]
                    }
                }
            ]
        });

        /*读入json文件=========================*/
        $.get('data.json').done(function (data) {
            myChart.setOption({
                series: [
                    {
                        name: data[0].name,
                        data: data[0].data
                    }
                    ,
                    {
                        name: data[1].name,
                        data: data[1].data
                    }]
            });
        });

        // $.get('data.json').done(function (data) {
        //     // 填入数据
        //     myChart.setOption({
        //         xAxis: {
        //             data: data.categories
        //         },
        //         series: [{
        //             // 根据名字对应到相应的系列
        //             name: '销量',
        //             data: data.data
        //         }]
        //     });
        // });

    });

    $("#rate_btn").click(function () {
        // $("#hello").show();
        /*初始化echarts实例=====================*/
        var myChart = echarts.init(document.getElementById('hello'));


        /* 指定图表的配置项和数据===============*/
        myChart.setOption({
            title: {
                text: '乘车率统计',
                subtext: '404厂车系统'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['理论乘车率', '实际乘车率']
            },
            toolbox: {
                show: true,
                feature: {
                    mark: {show: true},
                    dataView: {show: true, readOnly: false},
                    magicType: {show: true, type: ['bar', 'line']},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    boundaryGap: false,
                    axisLabel: {
                        formatter: function (val) {
                            return val.split("").join("\n");
                        }
                    },
                    data: ['101线', '102线', '103线', '104线', '105线', '106线', '107线', '101线', '102线', '103线', '104线', '105线', '106线', '107线']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} %'
                    }
                }
            ],
            series: [
                {
                    name: '理论乘车率',
                    type: 'line',
                    data: [],
                    // markPoint : {
                    //     data : [
                    //         {type : 'max', name: '最大值'},
                    //         {type : 'min', name: '最小值'}
                    //     ]
                    // },
                    markLine: {
                        data: [
                            {type: 'average', name: '平均值'}
                        ]
                    }
                },
                {
                    name: '实际乘车率',
                    type: 'line',
                    data: [],
                    // markPoint : {
                    //     data : [
                    //         {name : '周最低', value : -2, xAxis: 1, yAxis: -1.5}
                    //     ]
                    // },
                    markLine: {
                        data: [
                            {type: 'average', name: '平均值'}
                        ]
                    }
                }
            ]
        });

        /*读入json文件=========================*/
        $.get('data2.json').done(function (data) {
            myChart.setOption({
                series: [
                    {
                        name: data[0].name,
                        data: data[0].data
                    }
                    ,
                    {
                        name: data[1].name,
                        data: data[1].data
                    }]
            });
        });


    });

    $("#list_btn").click(function () {
        $("#hello").empty();
        var strHtml = "<table class='table table-striped table-bordered' id='logo'>";
        strHtml += "<thead><tr class='warning'><th>站点</th><th>人员名单</th></tr></thead>";
        strHtml += "<tbody>";
        $.getJSON("data3.json", function (data) {
            $.each(data, function (infoIndex, info) {
                strHtml += "<tr><td>" + info["name"] + "</td>";
                strHtml += "<td>" + info["list"] + "</td></tr>";
            });
            strHtml += "</tbody></table>";
            $("#hello").html(strHtml);  //显示处理后的数据     
        });
    });


</script>

<!-- 单日期选择框默认设置为今天 -->
<script language="javascript">
    var now = new Date();
    $('#birthday').val(now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate());
</script>

</body>
</html>
